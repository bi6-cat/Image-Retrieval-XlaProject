<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Animal Image Retrieval</title>
  <link rel="stylesheet" href="styles_improved.css">
</head>
<body>
  <header>
    <div class="header-content">
      <h1>ğŸ¾ Animal Image Retrieval</h1>
      <p class="subtitle">Intelligent search with visual feedback</p>
    </div>
  </header>

  <!-- Stats Bar -->
  <div id="statsBar" class="stats-bar">
    <span></span>
    <div style="display: flex; gap: 10px;">
      <a href="advanced_search.html" class="analytics-link">ğŸ” Advanced Search</a>
      <a href="analytics.html" class="analytics-link">ğŸ“Š Analytics</a>
    </div>
  </div>

  <div class="search-container">
    <div class="search-tabs">
      <button class="tab-btn active" onclick="switchTab('text')">ğŸ”¤ Text Search</button>
      <button class="tab-btn" onclick="switchTab('image')">ğŸ“¸ Image Search</button>
    </div>

    <div id="textSearch" class="search-panel active">
      <input id="queryInput" type="text" placeholder="Type your query (e.g., black cat sleeping)" />
      <button id="searchBtn" class="btn-primary">ğŸ” Search</button>
      <label style="margin-left: 15px; display: inline-flex; align-items: center; gap: 8px; cursor: pointer;">
        <input type="checkbox" id="autoFilterSpecies" checked style="cursor: pointer;">
        <span style="color: #666; font-size: 0.9rem;">Auto-filter by species (cat, dog, etc.)</span>
      </label>
    </div>

    <div id="imageSearch" class="search-panel">
      <input id="imageUpload" type="file" accept="image/*" style="display:none" />
      <button onclick="document.getElementById('imageUpload').click()" class="btn-primary">
        ğŸ“¤ Upload Image
      </button>
      <span id="fileName" class="file-name"></span>
      <button id="searchByImageBtn" class="btn-secondary" style="display:none">ğŸ” Search Similar</button>
    </div>
  </div>

  <div id="loading" class="loading" style="display:none">
    <div class="spinner"></div>
    <p>Searching...</p>
  </div>

  <div id="resultsInfo" class="results-info"></div>
  <div id="results" class="results-grid"></div>

  <div class="feedback-container">
    <div>
      <h3>ğŸ’¡ Refine Your Search</h3>
      <p class="hint">
        <strong>How it works:</strong><br>
        ğŸ‘ Mark images as <strong>Relevant</strong> (want more like this)<br>
        ğŸ‘ Mark images as <strong>Not Relevant</strong> (want less like this)<br>
        âœ¨ Click <strong>Refine</strong> button below to improve results
      </p>
      <div id="feedbackStats" class="feedback-stats"></div>
      
      <!-- Visual refine button -->
      <button id="visualRefineBtn" class="btn-refine">
        âœ¨ Refine Search
      </button>
      
      <!-- Optional text feedback (collapsible) -->
      <details class="text-feedback-details">
        <summary class="text-feedback-toggle">
          ğŸ“ Add text description (optional)
        </summary>
        <div class="text-feedback-content">
          <textarea id="feedbackText" 
                    placeholder="e.g., 'fluffy white cat in snow' or 'Nike running shoes red color'&#10;&#10;ğŸ’¡ Tip: Text is especially useful when searching by image to add context!"></textarea>
          <button id="manualRefineBtn" class="btn-refine-manual">
            âœ¨ Refine with Text
          </button>
        </div>
      </details>
    </div>
  </div>

  <!-- Search History -->
  <div class="history-container">
    <div>
      <h3>ğŸ“œ Recent Searches</h3>
      <button id="toggleHistory" class="btn-secondary" onclick="toggleHistory()">Show History</button>
      <div id="historyList" class="history-list" style="display:none"></div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
